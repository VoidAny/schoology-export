const getModulePath=e=>"https://raw.githubusercontent.com/mrhotmadm/schoology-export/refs/heads/main/"+e.replace("./",""),loadModule=async(e,t=!1)=>{let a=await fetch(t?e:getModulePath(e)).then(e=>e.text()),o=new Blob([a],{type:"text/javascript"}),r=URL.createObjectURL(o),s=await import(r);return URL.revokeObjectURL(r),s};(async()=>{let e=await loadModule("src/util.js"),{default:t}=await loadModule("src/inject.js"),{openAllFolders:a}=await loadModule("src/navigation.js"),{default:o}=await loadModule("src/scraper.js"),{default:r}=await loadModule("src/export.js");t();let s={"schoology-export:open-all-folders":a,async "schoology-export:scrape-trigger"(){let t=await o(e);sessionStorage.setItem("schoology-export:data",JSON.stringify(t)),console.log("[schoology-export] Scraped data:",t)},async "schoology-export:export-trigger"(e){let t=document.querySelector("#main-content-wrapper .page-title")?.innerText?.trim()||"Course",a=JSON.parse(sessionStorage.getItem("schoology-export:data")||"[]");if(!a||0===a.length)return alert("No data found. Please scrape the course materials first using the middle button."),console.warn("[schoology-export] No data found. Please scrape the course materials first.");let o=await r({name:t,materialData:a});sessionStorage.removeItem("schoology-export:data"),console.log(`[schoology-export] Exported ${o} files to ${name}.zip`)}};window.addEventListener("message",async e=>{if(e.source!==window||!e.data?.type?.startsWith("schoology-export"))return;let{type:t}=e.data;await s[t](t);let a=document.querySelector(`#${t.replace(":","\\:")}`);a.disabled=!1,a.innerText=a.getAttribute("original-text"),a.style.filter="brightness(1)"})})();